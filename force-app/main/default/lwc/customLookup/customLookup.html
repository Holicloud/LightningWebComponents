<template>
	<div class={requiredClass}>
		<label
			if:true={label}
			class="slds-form-element__label"
			for="combobox-id-4"
		>
			<template if:true={required}>
				<abbr class="slds-required" title="required">*</abbr>
			</template>
			{label}
		</label>
		<template if:true={helpText}>
			<lightning-helptext content={helpText}></lightning-helptext>
		</template>
		<div class="slds-form-element__control">
			<template if:true={recordSelected}>
				<div class="slds-combobox_container slds-has-selection">
					<div
						class="
							slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click
						"
						aria-expanded="false"
						aria-haspopup="listbox"
						role="combobox"
					>
						<div
							class="
								slds-combobox__form-element
								slds-input-has-icon slds-input-has-icon_left-right
							"
							role="none"
						>
							<span
								class="
									slds-icon_container
									slds-icon-standard-account
									slds-combobox__input-entity-icon
								"
								title="Account"
							>
								<lightning-icon
									icon-name={iconName}
									size="x-small"
								></lightning-icon>
							</span>
							<input
								type="text"
								class="slds-input slds-combobox__input"
								id="combobox-id-5"
								aria-controls="listbox-id-5"
								autocomplete="off"
								role="textbox"
								placeholder="Select an Option"
								style="pointer-events: none"
								value={primaryFieldDisplayableValue}
								disabled={disabled}
							/>
							<button
								class="
									slds-button slds-button_icon
									slds-input__icon slds-input__icon_right
								"
							>
								<lightning-button-icon
									disabled={disabled}
									onmousedown={handleRemove}
									icon-name="utility:close"
									variant="bare"
									alternative-text="Clear Selection"
								>
								</lightning-button-icon>
							</button>
						</div>
					</div>
				</div>
			</template>
			<div class="search-class">
				<div class="slds-combobox_container">
					<div
						class={resultClass}
						aria-expanded="true"
						aria-haspopup="listbox"
						role="combobox"
					>
						<div
							class="
								slds-combobox__form-element
								slds-input-has-icon slds-input-has-icon_right
							"
							role="none"
						>
							<input
								type="text"
								data-id="input"
								class="
									slds-input
									slds-combobox__input slds-combobox__input-value
								"
								id="combobox-id-4"
								aria-activedescendant="option1"
								aria-autocomplete="list"
								aria-controls="listbox-id-4"
								autocomplete="off"
								role="textbox"
								placeholder={thePlaceHolder}
								onkeyup={handleOnchange}
								value={searchKey}
								disabled={disabled}
								onfocus={handleOnFocus}
								onblur={inblurEdge}
								required
							/>
							<span class="slds-input__icon-group slds-input__icon-group_right">
								<template if:true={showSpinner}>
									<div
										role="status"
										class="
											slds-spinner slds-spinner_brand slds-spinner_x-small
											slds-input__spinner
										"
									>
										<span class="slds-assistive-text">Loading</span>
										<div class="slds-spinner__dot-a"></div>
										<div class="slds-spinner__dot-b"></div>
									</div>
								</template>
								<div
									class="
										slds-button slds-button_icon
										slds-input__icon slds-input__icon_right
									"
									title="Search"
								>
									<span class="slds-assistive-text">Search</span>
									<lightning-icon
										icon-name="utility:search"
										size="x-small"
									></lightning-icon>
								</div>
							</span>
						</div>
						<div
							tabindex="0"
							onblur={inblur}
							id="listbox-id-4"
							class="
								slds-dropdown
								slds-dropdown_length-with-icon-7
								slds-dropdown_fluid
							"
							role="listbox"
						>
							<ul
								class="slds-listbox slds-listbox_vertical"
								role="presentation"
							>
								<li
									role="presentation"
									class="slds-listbox__item"
									onmousedown={openExpandedLookup}
								>
									<div
										aria-selected="true"
										id="option0"
										class="
											slds-media
											slds-listbox__option
											slds-listbox__option_entity
											slds-listbox__option_term
											slds-has-focus
										"
										role="option"
									>
										<template if:true={displaySearchIcon}
											><lightning-icon
												icon-name="utility:search"
												size="x-small"
											></lightning-icon
										></template>
										<span class="slds-media__body">
											<span
												class="
													slds-listbox__option-text
													slds-listbox__option-text_entity
												"
												>{searchLabel}</span
											>
										</span>
									</div>
								</li>
								<template if:true={records} for:each={records} for:item="record">
									<c-custom-lookup-results
										fields={_fields}
										icon-name={iconName}
										search-key={searchKey}
										key={record.Id}
										onselect={handleSelect}
										record={record}
									></c-custom-lookup-results>
								</template>
								<template if:true={error}>
									<span class="slds-media__body">
										<span
											class="
												slds-align_absolute-center
												slds-box
												slds-theme_shade slds-theme_error
											"
											>{error}</span
										>
									</span>
								</template>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div if:true={bottomText} class="slds-form-element__help">{bottomText}</div>
		</div>
		<template if:true={displayRequiredMessage}>
			<div class="slds-form-element__help" id="error-message-unique-id">
				Complete this field.
			</div>
		</template>
	</div>
	<!-- <c-expanded-list-view-custom-lookup
		data-id="thePopUp"
		additional-search-by-fields={additionalSearchByFields}
		columns={expandedViewColumns}
		icon-name={iconName}
		limit-of-records={limitOfRecordsExpandedLookup}
		object-api-name={objectApiName}
		object-label={objectLabel}
		search-by-api-name={searchByApiName}
		search-key={searchKey}
		where-clause={whereClause}
		onrowaction={handleRowAction}
		oncancel={handleCancelModal}
	></c-expanded-list-view-custom-lookup> -->
</template>
